@model IEnumerable<WebshopFeature>
@using Sana.Sim.Business.Entities
@{
    var featuresHelper = new FeaturesHelper();
    var features = featuresHelper.Features;
}

<div class="features-groups-list">
    <h2>Actions</h2>

    <div class="features-group">
        <ul class="features-list reset">
            @foreach (var feature in features.Where(f => f.IsAction))
            {
                var price = feature.ImplementationCost;
                var usedFeature = Model?.SingleOrDefault(f => f.Definition.Id == feature.Id);
                var inputUsedAttribute = usedFeature != null ? "disabled='disabled' checked='checked'" : "name=Features";
                var featureUsedAttribute = usedFeature != null ? "used-feature" : "";
                <li class="feature @featureUsedAttribute">
                    <label data-id="@feature.Id" class="toggler">
                        <input type="checkbox" value="@feature.Id" data-id="@feature.Id" @inputUsedAttribute />
                        <i><span class="on"></span><span class="off"></span></i>
                        @feature.Name - $@Html.FormatPrice(price)
                    </label>
                    <div class="description">
                        @feature.ImpactMessage
                    </div>
                    @if (usedFeature != null)
                    {
                        @Html.Partial("_ProgressBar", (int)((Framework.Context.IterationNumber - usedFeature.AddedOnIteration) / feature.Duration * 100))
                    }
                    <div class="tooltip"><i class="fa fa-question-circle" aria-hidden="true"></i></div>
                </li>
            }
        </ul>
    </div>
</div>